version: '3.1'
services:

  monitor-service:
    container_name: monitor-service
    build:
      context: ./
      dockerfile: Dockerfile
    image: monitor-service:latest
    ports:
      - 8080:8080
    environment:
      SPRING_APPLICATION_JSON: '{
          "spring.datasource.url": "jdbc:mysql://docker-mysql:3306/appliftingdb?autoReconnect=true&useSSL=false",
          "spring.datasource.password": "root",
          "spring.datasource.username": "root",
          "spring.jpa.hibernate.ddl-auto": "update",
          "spring.jpa.show-sql": "true",
          "spring.jpa.properties.hibernate.dialect": "org.hibernate.dialect.MySQL8Dialect",
          "spring.jpa.properties.hibernate.format_sql": "true"
        }'
    networks:
      - spring-cloud-network

  docker-mysql:
    image: mysql:latest
    restart: always
    ports:
      - 3306:3306
    environment:
      MYSQL_ROOT_PASSWORD: root
      MYSQL_DATABASE: appliftingdb
      MYSQL_PASSWORD: root
    security_opt:
      - seccomp:unconfined
    networks:
      - spring-cloud-network

networks:
    spring-cloud-network:
      driver: bridge